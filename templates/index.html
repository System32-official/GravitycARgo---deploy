<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GravitycARgo | Container Loading Optimizer</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="shortcut icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">

    <!-- External CSS Libraries -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.css"
    />
    <link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css" />

    <!-- Custom CSS -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/base.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/layout.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/components.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/animations.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/responsive.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style-index.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/container-visualization.css') }}"
    />
  </head>

  <body data-scroll-container>
    <!-- 3D Background Elements -->
    <div class="floating-elements">
      <div class="floating-cube"></div>
      <div class="floating-cube"></div>
      <div class="floating-cube"></div>
      <div class="floating-pyramid"></div>
      <div class="floating-sphere"></div>
      <div class="gradient-blob"></div>
      <div class="gradient-blob blob-secondary"></div>
    </div>

    <!-- Animated Background Grid -->
    <div class="background-grid">
      <div class="grid-overlay"></div>
    </div>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg">
      <div class="container">
        <a class="navbar-brand" href="/">
          <i class="fas fa-cube logo-icon"></i>
          <span class="logo-text">Gravity<span class="highlight">cARgo</span></span>
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="/"><i class="fas fa-home"></i> Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#features"><i class="fas fa-star"></i> Features</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#how-it-works"><i class="fas fa-info-circle"></i> How it Works</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#contact"><i class="fas fa-envelope"></i> Contact</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="optimizer-container page-transition-wrapper page-enter">
      <div class="container">
        <!-- Header Section -->
        <div class="optimizer-header" data-scroll data-scroll-speed="1">
          <div class="tech-badge" data-aos="fade-down">
            <i class="fas fa-cube badge-icon"></i>
            <span class="badge-text">Advanced AI Optimization</span>
          </div>
          <h1 class="optimizer-title" data-aos="fade-down" data-aos-delay="100">
            Smart Container <span class="text-gradient">Optimization</span>
          </h1>
          <p class="optimizer-subtitle" data-aos="fade-down" data-aos-delay="200">
            Maximize space efficiency with our AI-powered 3D container packing solution
          </p>
        </div>

        <!-- Main Form Card -->
        <div class="wizard-card" data-aos="zoom-in" data-aos-delay="300">
          <div class="card-glow"></div>
          
          <!-- Progress Steps -->
          <div class="progress-steps">
            <div class="step active" data-step="1">
              <div class="step-icon">
                <i class="fas fa-shipping-fast"></i>
              </div>
              <div class="step-label">Transport Mode</div>
            </div>
            <div class="step" data-step="2">
              <div class="step-icon">
                <i class="fas fa-upload"></i>
              </div>
              <div class="step-label">Upload Data</div>
            </div>
            <div class="step" data-step="3">
              <div class="step-icon">
                <i class="fas fa-cog"></i>
              </div>
              <div class="step-label">Settings</div>
            </div>
            <div class="step" data-step="4">
              <div class="step-icon">
                <i class="fas fa-rocket"></i>
              </div>
              <div class="step-label">Optimize</div>
            </div>
          </div>

          <form id="optimizerForm" method="post" action="/optimize" enctype="multipart/form-data">
            <div class="form-sections">
              <!-- Step 1: Transport Mode Selection -->
              <div class="form-section active" data-step="1">
                <h3 class="section-title">
                  <i class="fas fa-shipping-fast"></i>
                  Select Transport Mode
                </h3>
                <p class="section-description">
                  Choose your preferred transportation method to optimize container selection
                </p>
                
                <input type="hidden" id="transport_mode" name="transport_mode" required>
                
                <div class="transport-cards">
                  <div class="transport-option transport-3d" data-value="1">
                    <div class="transport-option-inner">
                      <div class="option-icon-wrapper">
                        <div class="icon-effect road-effect">
                          <div class="road-line"></div>
                          <div class="road-line"></div>
                        </div>
                        <i class="fas fa-truck"></i>
                      </div>
                      <h4 class="option-title">Truck</h4>
                      <p class="option-description">Road transportation for domestic and regional deliveries</p>
                      <div class="option-badges">
                        <span class="option-badge">
                          <i class="fas fa-clock"></i>
                          Fast
                        </span>
                        <span class="option-badge">
                          <i class="fas fa-dollar-sign"></i>
                          Economic
                        </span>
                      </div>
                    </div>
                    <div class="option-check">
                      <i class="fas fa-check"></i>
                    </div>
                  </div>

                  <div class="transport-option transport-3d" data-value="2">
                    <div class="transport-option-inner">
                      <div class="option-icon-wrapper">
                        <div class="icon-effect sea-effect">
                          <div class="wave"></div>
                          <div class="wave"></div>
                        </div>
                        <i class="fas fa-ship"></i>
                      </div>
                      <h4 class="option-title">Ship</h4>
                      <p class="option-description">Ocean freight for international bulk shipments</p>
                      <div class="option-badges">
                        <span class="option-badge">
                          <i class="fas fa-weight-hanging"></i>
                          Heavy Cargo
                        </span>
                        <span class="option-badge">
                          <i class="fas fa-globe"></i>
                          Global
                        </span>
                      </div>
                    </div>
                    <div class="option-check">
                      <i class="fas fa-check"></i>
                    </div>
                  </div>

                  <div class="transport-option transport-3d" data-value="3">
                    <div class="transport-option-inner">
                      <div class="option-icon-wrapper">
                        <div class="icon-effect air-effect">
                          <div class="cloud"></div>
                          <div class="cloud"></div>
                        </div>
                        <i class="fas fa-plane"></i>
                      </div>
                      <h4 class="option-title">Plane</h4>
                      <p class="option-description">Air freight for urgent and high-value cargo</p>
                      <div class="option-badges">
                        <span class="option-badge">
                          <i class="fas fa-bolt"></i>
                          Express
                        </span>
                        <span class="option-badge">
                          <i class="fas fa-shield-alt"></i>
                          Secure
                        </span>
                      </div>
                    </div>
                    <div class="option-check">
                      <i class="fas fa-check"></i>
                    </div>
                  </div>

                  <div class="transport-option transport-3d" data-value="4">
                    <div class="transport-option-inner">
                      <div class="option-icon-wrapper">
                        <div class="icon-effect rail-effect">
                          <div class="track"></div>
                          <div class="track"></div>
                        </div>
                        <i class="fas fa-train"></i>
                      </div>
                      <h4 class="option-title">Train</h4>
                      <p class="option-description">Railway transport for efficient land freight</p>
                      <div class="option-badges">
                        <span class="option-badge">
                          <i class="fas fa-leaf"></i>
                          Eco-friendly
                        </span>
                        <span class="option-badge">
                          <i class="fas fa-boxes"></i>
                          Bulk
                        </span>
                      </div>
                    </div>
                    <div class="option-check">
                      <i class="fas fa-check"></i>
                    </div>
                  </div>

                  <div class="transport-option transport-3d" data-value="5">
                    <div class="transport-option-inner">
                      <div class="option-icon-wrapper">
                        <div class="icon-effect custom-effect">
                          <div class="pulse-ring"></div>
                          <div class="pulse-ring"></div>
                        </div>
                        <i class="fas fa-tools"></i>
                      </div>
                      <h4 class="option-title">Custom</h4>
                      <p class="option-description">Define your own container specifications</p>
                      <div class="option-badges">
                        <span class="option-badge">
                          <i class="fas fa-cogs"></i>
                          Flexible
                        </span>
                        <span class="option-badge">
                          <i class="fas fa-ruler"></i>
                          Custom Size
                        </span>
                      </div>
                    </div>
                    <div class="option-check">
                      <i class="fas fa-check"></i>
                    </div>
                  </div>
                </div>

                <!-- Container Selection -->
                <div class="container-selection" id="container_options" style="display: none;">
                  <h4>Select Container Type</h4>
                  <input type="hidden" id="container_type" name="container_type">
                  <div class="container-grid" id="containerGrid">
                    <!-- Container options will be populated by JavaScript -->
                  </div>
                </div>

                <!-- Custom Dimensions -->
                <div class="custom-dimensions" id="custom_dimensions">
                  <h4>Custom Container Dimensions</h4>
                  <div class="dimension-inputs">
                    <div class="dimension-input">
                      <label for="length">Length (m)</label>
                      <input type="number" id="length" name="length" step="0.01" min="0.1" placeholder="12.00">
                      <i class="fas fa-arrows-alt-h dimension-icon"></i>
                    </div>
                    <div class="dimension-input">
                      <label for="width">Width (m)</label>
                      <input type="number" id="width" name="width" step="0.01" min="0.1" placeholder="2.35">
                      <i class="fas fa-arrows-alt-v dimension-icon"></i>
                    </div>
                    <div class="dimension-input">
                      <label for="height">Height (m)</label>
                      <input type="number" id="height" name="height" step="0.01" min="0.1" placeholder="2.39">
                      <i class="fas fa-arrows-alt dimension-icon"></i>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Step 2: File Upload -->
              <div class="form-section" data-step="2">
                <h3 class="section-title">
                  <i class="fas fa-upload"></i>
                  Upload Item Data
                </h3>
                <p class="section-description">
                  Upload your CSV or Excel file containing item information
                </p>

                <div class="file-upload-container">
                  <div class="upload-zone" id="dropZone">
                    <input type="file" id="file_input" name="file" class="file-input" accept=".csv,.xlsx,.xls" required>
                    <div class="upload-animation">
                      <div class="upload-rings">
                        <div class="ring"></div>
                        <div class="ring"></div>
                        <div class="ring"></div>
                      </div>
                      <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    </div>
                    <h4>Drop your file here or click to browse</h4>
                    <div class="upload-formats">
                      <span class="format-badge">
                        <i class="fas fa-file-csv"></i>
                        CSV
                      </span>
                      <span class="format-badge">
                        <i class="fas fa-file-excel"></i>
                        Excel
                      </span>
                    </div>
                    <button type="button" class="browse-btn">Browse Files</button>
                  </div>

                  <div class="file-info" id="file-info">
                    <div class="file-preview">
                      <i class="fas fa-file-alt file-icon"></i>
                      <div class="file-details">
                        <span class="file-name" id="fileName"></span>
                        <span class="file-size" id="fileSize"></span>
                      </div>
                      <button type="button" class="remove-file" id="removeFile">
                        <i class="fas fa-times"></i>
                      </button>
                    </div>
                  </div>

                  <div class="template-downloads">
                    <p>Need a template? Download our sample files:</p>
                    <div class="template-buttons">
                      <button type="button" class="btn-template" onclick="window.open('/static/templates/template.csv', '_blank')">
                        <i class="fas fa-download"></i> CSV Template
                      </button>
                      <button type="button" class="btn-template" onclick="window.open('/static/templates/template.xlsx', '_blank')">
                        <i class="fas fa-download"></i> Excel Template
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Step 3: Settings -->
              <div class="form-section" data-step="3">
                <h3 class="section-title">
                  <i class="fas fa-cog"></i>
                  Optimization Settings
                </h3>
                <p class="section-description">
                  Configure advanced settings for optimal packing
                </p>

                <!-- Temperature Setting -->
                <div class="settings-container">
                  <div class="setting-group">
                    <i class="fas fa-thermometer-half setting-icon"></i>
                    <div class="setting-content">
                      <h4>Route Temperature</h4>
                      <p>Set the expected temperature during transport (optional)</p>
                      
                      <div class="temperature-slider-container">
                        <div class="temperature-range">
                          <span class="temp-min">-40°C</span>
                          <div class="temp-slider-wrapper">
                            <input type="range" id="temp_slider" class="temp-slider" min="-40" max="70" value="20" step="1">
                            <div class="temp-tooltip" id="tempTooltip">20°C</div>
                          </div>
                          <span class="temp-max">70°C</span>
                        </div>
                        <input type="hidden" id="route_temperature" name="route_temperature" value="">
                      </div>

                      <div class="temperature-info">
                        <div class="temp-info-item cold">
                          <i class="fas fa-snowflake"></i>
                          <span>Cold: Below 0°C</span>
                        </div>
                        <div class="temp-info-item hot">
                          <i class="fas fa-fire"></i>
                          <span>Hot: Above 30°C</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Constraint Settings -->
                <div class="settings-container">
                  <div class="setting-group">
                    <i class="fas fa-sliders-h setting-icon"></i>
                    <div class="setting-content">
                      <h4>Optimization Constraints</h4>
                      <p>Adjust the weights for different optimization factors</p>
                      
                      <div class="constraint-sliders">
                        <!-- Volume Utilization -->
                        <div class="constraint-slider-item">
                          <label class="form-label-sm">
                            <i class="fas fa-cube"></i>
                            Volume Utilization
                          </label>
                          <div class="d-flex align-items-center gap-3">
                            <input type="range" class="constraint-slider" id="volume_weight" name="volume_weight" 
                                   min="0" max="100" value="75" step="1">
                            <span class="weight-value" id="volume_weight_value">75%</span>
                          </div>
                        </div>

                        <!-- Stability Score -->
                        <div class="constraint-slider-item">
                          <label class="form-label-sm">
                            <i class="fas fa-balance-scale"></i>
                            Stability Score
                          </label>
                          <div class="d-flex align-items-center gap-3">
                            <input type="range" class="constraint-slider" id="stability_weight" name="stability_weight" 
                                   min="0" max="100" value="50" step="1">
                            <span class="weight-value" id="stability_weight_value">50%</span>
                          </div>
                        </div>

                        <!-- Contact Ratio -->
                        <div class="constraint-slider-item">
                          <label class="form-label-sm">
                            <i class="fas fa-handshake"></i>
                            Contact Ratio
                          </label>
                          <div class="d-flex align-items-center gap-3">
                            <input type="range" class="constraint-slider" id="contact_weight" name="contact_weight" 
                                   min="0" max="100" value="50" step="1">
                            <span class="weight-value" id="contact_weight_value">50%</span>
                          </div>
                        </div>

                        <!-- Weight Balance -->
                        <div class="constraint-slider-item">
                          <label class="form-label-sm">
                            <i class="fas fa-weight-hanging"></i>
                            Weight Balance
                          </label>
                          <div class="d-flex align-items-center gap-3">
                            <input type="range" class="constraint-slider" id="balance_weight" name="balance_weight" 
                                   min="0" max="100" value="25" step="1">
                            <span class="weight-value" id="balance_weight_value">25%</span>
                          </div>
                        </div>

                        <!-- Items Packed Ratio -->
                        <div class="constraint-slider-item">
                          <label class="form-label-sm">
                            <i class="fas fa-boxes"></i>
                            Items Packed Ratio
                          </label>
                          <div class="d-flex align-items-center gap-3">
                            <input type="range" class="constraint-slider" id="items_packed_weight" name="items_packed_weight" 
                                   min="0" max="100" value="25" step="1">
                            <span class="weight-value" id="items_packed_weight_value">25%</span>
                          </div>
                        </div>

                        <!-- Temperature Constraint -->
                        <div class="constraint-slider-item">
                          <label class="form-label-sm">
                            <i class="fas fa-thermometer-half"></i>
                            Temperature Constraint
                          </label>
                          <div class="d-flex align-items-center gap-3">
                            <input type="range" class="constraint-slider" id="temperature_weight" name="temperature_weight" 
                                   min="0" max="100" value="30" step="1">
                            <span class="weight-value" id="temperature_weight_value">30%</span>
                          </div>
                        </div>

                        <!-- Weight Bearing Capacity -->
                        <div class="constraint-slider-item">
                          <label class="form-label-sm">
                            <i class="fas fa-weight"></i>
                            Weight Bearing Capacity
                          </label>
                          <div class="d-flex align-items-center gap-3">
                            <input type="range" class="constraint-slider" id="weight_capacity" name="weight_capacity" 
                                   min="0" max="100" value="50" step="1">
                            <span class="weight-value" id="weight_capacity_value">50%</span>
                          </div>
                        </div>
                      </div>

                      <div class="constraint-presets mt-4">
                        <div class="d-flex gap-2">
                          <button type="button" class="constraint-preset" data-preset="balanced">
                            <i class="fas fa-balance-scale"></i>
                            Balanced
                          </button>
                          <button type="button" class="constraint-preset" data-preset="volume">
                            <i class="fas fa-cube"></i>
                            Volume Focus
                          </button>
                          <button type="button" class="constraint-preset" data-preset="stability">
                            <i class="fas fa-shield-alt"></i>
                            Stability Focus
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Step 4: Review & Submit -->
              <div class="form-section" data-step="4">
                <h3 class="section-title">
                  <i class="fas fa-check-circle"></i>
                  Review & Optimize
                </h3>
                <p class="section-description">
                  Review your settings and start the optimization process
                </p>

                <!-- Algorithm Selection -->
                <div class="settings-container">
                  <div class="setting-group">
                    <i class="fas fa-microchip setting-icon"></i>
                    <div class="setting-content">
                      <h4>Optimization Algorithm</h4>
                      <p>Choose between regular packing or AI-enhanced genetic algorithm</p>
                      
                      <div class="algorithm-selection">
                        <div class="algorithm-option" data-algorithm="regular">
                          <input type="radio" id="algorithm_regular" name="optimization_mode" value="regular" checked style="display: none;">
                          <div class="algorithm-icon">
                            <i class="fas fa-box"></i>
                          </div>
                          <div class="algorithm-info">
                            <h5>Regular Packing</h5>
                            <p>Fast and efficient for simple packing scenarios</p>
                            <ul class="algorithm-features">
                              <li><i class="fas fa-check"></i> Quick optimization</li>
                              <li><i class="fas fa-check"></i> Basic constraints</li>
                              <li><i class="fas fa-check"></i> Suitable for standard loads</li>
                            </ul>
                          </div>
                          <div class="algorithm-check">
                            <i class="fas fa-check"></i>
                          </div>
                        </div>

                        <div class="algorithm-option" data-algorithm="genetic">
                          <input type="radio" id="algorithm_genetic" name="optimization_mode" value="genetic" style="display: none;">
                          <div class="algorithm-icon">
                            <i class="fas fa-dna"></i>
                          </div>
                          <div class="algorithm-info">
                            <h5>AI-Enhanced Genetic</h5>
                            <p>Advanced optimization with machine learning</p>
                            <ul class="algorithm-features">
                              <li><i class="fas fa-check"></i> Complex constraints</li>
                              <li><i class="fas fa-check"></i> Better space utilization</li>
                              <li><i class="fas fa-check"></i> Temperature & weight optimization</li>
                            </ul>
                          </div>
                          <div class="algorithm-check">
                            <i class="fas fa-check"></i>
                          </div>
                        </div>
                      </div>
                      <input type="hidden" id="optimization_algorithm" name="optimization_algorithm" value="regular">

                      <!-- Genetic Algorithm Controls -->
                      <div class="genetic-controls mt-4" style="display: none;">
                        <h5 class="mb-3">Genetic Algorithm Settings</h5>
                        
                        <!-- Population Size -->
                        <div class="constraint-slider-item">
                          <label class="form-label-sm">
                            <i class="fas fa-users"></i>
                            Population Size
                          </label>
                          <div class="d-flex align-items-center gap-3">
                            <input type="number" class="form-control form-control-sm" style="width: 100px;" id="population_size" name="population_size" 
                                   min="10" max="500" value="75" step="1">
                            <span class="weight-value" id="population_size_value">75</span>
                          </div>
                          <small class="form-text text-muted">Number of solutions in each generation. Recommended: 50-200.</small>
                        </div>

                        <!-- Number of Generations -->
                        <div class="constraint-slider-item">
                          <label class="form-label-sm">
                            <i class="fas fa-sync"></i>
                            Number of Generations
                          </label>
                          <div class="d-flex align-items-center gap-3">
                            <input type="number" class="form-control form-control-sm" style="width: 100px;" id="num_generations" name="num_generations" 
                                   min="5" max="200" value="30" step="1">
                            <span class="weight-value" id="num_generations_value">30</span>
                          </div>
                          <small class="form-text text-muted">How many cycles the algorithm runs. Recommended: 30-100.</small>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="review-summary">
                  <div class="summary-item">
                    <strong>Transport Mode:</strong> <span id="reviewTransportMode">Not selected</span>
                  </div>
                  <div class="summary-item">
                    <strong>Container Type:</strong> <span id="reviewContainerType">Not selected</span>
                  </div>
                  <div class="summary-item">
                    <strong>File:</strong> <span id="reviewFileName">No file uploaded</span>
                  </div>
                  <div class="summary-item">
                    <strong>Route Temperature:</strong> <span id="reviewRouteTemperature">Not specified</span>
                  </div>
                  <div class="summary-item">
                    <strong>Optimization Algorithm:</strong> <span id="reviewOptimizationAlgorithm">Not selected</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="form-navigation">
              <button type="button" class="btn-prev" id="prev1" style="display: none;">
                <i class="fas fa-arrow-left"></i>
                Previous
              </button>
              <button type="button" class="btn-next" id="next1">
                Next
                <i class="fas fa-arrow-right"></i>
              </button>
            </div>
          </form>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="app-footer">
      <div class="container">
        <div class="footer-content">
          <div class="footer-logo">
            <i class="fas fa-cube"></i>
            <span>GravitycARgo</span>
          </div>
          <div class="footer-links">
            <div class="link-group">
              <h4>Quick Links</h4>
              <ul>
                <li><a href="/">Home</a></li>
                <li><a href="#features">Features</a></li>
                <li><a href="#how-it-works">How It Works</a></li>
                <li><a href="#contact">Contact</a></li>
              </ul>
            </div>
            <div class="link-group">
              <h4>Resources</h4>
              <ul>
                <li><a href="/docs">Documentation</a></li>
                <li><a href="/templates">Templates</a></li>
                <li><a href="/faq">FAQ</a></li>
                <li><a href="/support">Support</a></li>
              </ul>
            </div>
            <div class="link-group">
              <h4>Contact Us</h4>
              <ul>
                <li><i class="fas fa-envelope"></i> contact@gravitycargo.com</li>
                <li><i class="fas fa-phone"></i> +1 (555) 123-4567</li>
                <li><i class="fas fa-map-marker-alt"></i> 123 Shipping Lane<br>Logistics City, LC 12345</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="footer-copyright">
          <p>&copy; 2025 GravitycARgo. All rights reserved.</p>
          <div class="social-links">
            <a href="#"><i class="fab fa-facebook"></i></a>
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-linkedin"></i></a>
            <a href="#"><i class="fab fa-youtube"></i></a>
          </div>
        </div>
      </div>
    </footer>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
      <div class="loading-container">
        <div class="loading-spinner">
          <div class="spinner-ring"></div>
          <div class="spinner-ring"></div>
          <div class="spinner-ring"></div>
        </div>
        <h3 class="loading-text">Optimizing Container</h3>
        <p class="loading-status">Analyzing item dimensions and constraints...</p>
      </div>
    </div>    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>    
    <!-- Core application scripts -->
    <script src="{{ url_for('static', filename='js/container-visualization.js') }}"></script>
    <script src="{{ url_for('static', filename='js/chart-scripts.js') }}"></script>
    <script src="{{ url_for('static', filename='js/threejs-visualization.js') }}"></script>
    <script src="{{ url_for('static', filename='js/index-fixed.js') }}"></script>
    
    <!-- Hidden data for JavaScript -->
    <script type="application/json" id="flask-data">{{ data | tojson | safe }}</script>
    
    <script type="text/javascript">
      // Initialize AOS animations
      AOS.init({
        offset: 100,
        duration: 600,
        easing: 'ease-in-out',
        once: true
      });

      // Initialize Locomotive Scroll for smooth scrolling
      const scroll = new LocomotiveScroll({
        el: document.querySelector('[data-scroll-container]'),
        smooth: true,
        smartphone: { smooth: false },
        tablet: { smooth: false }
      });

      // Get the data passed from Flask
      let defaultData;
      try {
        const dataElement = document.getElementById('flask-data');
        defaultData = dataElement ? JSON.parse(dataElement.textContent) : { transport_modes: [] };
      } catch (e) {
        console.error('Error parsing Flask data:', e);
        defaultData = { transport_modes: [] };
      }

      // Debug: Log all available transport modes and containers
      console.log("All transport modes:", defaultData.transport_modes);
      defaultData.transport_modes.forEach(mode => {
        console.log(`${mode.name} has ${mode.containers ? mode.containers.length : 0} container types`);
      });

      document.addEventListener('DOMContentLoaded', function() {
        console.log("DOM fully loaded - initializing GravitycARgo application");
        
        // Initialize all variables in one place to avoid duplicate declarations
        const fileInput = document.getElementById('file_input');
        const dropZone = document.getElementById('dropZone');
        const fileInfo = document.getElementById('file-info');
        const fileName = document.getElementById('fileName');
        const fileSize = document.getElementById('fileSize');
        const removeFile = document.getElementById('removeFile');
        const tempSlider = document.getElementById('temp_slider');
        const tempInput = document.getElementById('route_temperature');
        const transportModeInput = document.getElementById('transport_mode');
        const containerTypeInput = document.getElementById('container_type');
        const customDimensions = document.getElementById('custom_dimensions');
        const optimizerForm = document.getElementById('optimizerForm');
        const sections = document.querySelectorAll('.form-section');
        const steps = document.querySelectorAll('.step');
        const nextBtn = document.getElementById('next1');
        const prevBtn = document.getElementById('prev1');
        
        console.log("Form sections found:", sections.length);
        console.log("Navigation steps found:", steps.length);

        // Error notification function
        function showError(message) {
          const notification = document.createElement('div');
          notification.className = 'error-notification';
          notification.innerHTML = `
            <div class="error-icon"><i class="fas fa-exclamation-circle"></i></div>
            <div class="error-message">${message}</div>
          `;
          
          document.body.appendChild(notification);
          
          setTimeout(() => {
            notification.classList.add('visible');
          }, 10);
          
          setTimeout(() => {
            notification.classList.remove('visible');
            setTimeout(() => {
              document.body.removeChild(notification);
            }, 300);
          }, 3000);
        }

        // Navigation handled by index-fixed.js

        // goToStep function handled by index-fixed.js

        // updateStepNavigation function handled by index-fixed.js

        // updateReviewSummary function handled by index-fixed.js

        // Algorithm selection handled by index-fixed.js

        // Add debugging for constraint sliders
        function debugConstraintSliders() {
          console.log("=== DEBUGGING CONSTRAINT SLIDERS ===");
          const sliders = document.querySelectorAll('.constraint-slider');
          const sliderItems = document.querySelectorAll('.constraint-slider-item');
          const constraintSection = document.querySelector('.constraint-sliders');
          
          console.log("Found constraint sliders:", sliders.length);
          console.log("Found constraint slider items:", sliderItems.length);
          console.log("Constraint section visible:", constraintSection ? window.getComputedStyle(constraintSection).display : 'not found');
          
          sliders.forEach((slider, index) => {
            const valueDisplay = document.getElementById(slider.id + '_value');
            console.log(`Slider ${index}: ID=${slider.id}, Value=${slider.value}, Display=${valueDisplay ? 'found' : 'missing'}`);
            
            // Ensure slider is visible and functional
            if (slider.style.display === 'none') {
              console.log(`Slider ${slider.id} is hidden!`);
            }
          });
          
          // Check if constraint sliders are in the DOM
          const volumeSlider = document.getElementById('volume_weight');
          const stabilitySlider = document.getElementById('stability_weight');
          console.log("Volume slider found:", !!volumeSlider);
          console.log("Stability slider found:", !!stabilitySlider);
        }

        // Enhanced initialization
        function initializeConstraintSliders() {
          const sliders = {
            'volume_weight': 'volume_weight_value',
            'stability_weight': 'stability_weight_value',
            'contact_weight': 'contact_weight_value',
            'balance_weight': 'balance_weight_value',
            'items_packed_weight': 'items_packed_weight_value',
            'temperature_weight': 'temperature_weight_value',
            'weight_capacity': 'weight_capacity_value',
            'population_size': 'population_size_value',
            'num_generations': 'num_generations_value'
          };

          console.log("Initializing constraint sliders...");
          let initializedCount = 0;

          Object.entries(sliders).forEach(([sliderId, valueId]) => {
            const slider = document.getElementById(sliderId);
            const valueDisplay = document.getElementById(valueId);
            
            if (slider && valueDisplay) {
              // Set initial value
              const isWeight = sliderId.includes('weight');
              const suffix = isWeight ? '%' : '';
              valueDisplay.textContent = slider.value + suffix;
              
              // Add event listener
              slider.addEventListener('input', function() {
                valueDisplay.textContent = this.value + suffix;
                console.log(`Slider ${sliderId} changed to: ${this.value}`);
              });
              
              initializedCount++;
              console.log(`✓ Initialized ${sliderId} with value ${slider.value}`);
            } else {
              console.log(`✗ Failed to initialize ${sliderId}: slider=${!!slider}, display=${!!valueDisplay}`);
            }
          });
          
          console.log(`Initialized ${initializedCount}/${Object.keys(sliders).length} constraint sliders`);
        }

        // Initialize the form navigation
        document.addEventListener('DOMContentLoaded', function() {
          console.log("DOM Content Loaded - starting initialization...");
          
          // Debug constraint sliders
          debugConstraintSliders();
          
          // Initialize components
          initializeConstraintSliders();
          initializeAlgorithmSelection();
          goToStep(1);
          updateStepNavigation();
          
          console.log("Initialization complete");
        });

        // Add form submission handler
        if (optimizerForm) {
          optimizerForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validate form before submission
            if (!transportModeInput.value) {
              showError('Please select a transport mode');
              return false;
            }
            
            if (transportModeInput.value !== '5' && !containerTypeInput.value) {
              showError('Please select a container type');
              return false;
            }
            
            if (transportModeInput.value === '5') {
              const length = document.getElementById('length');
              const width = document.getElementById('width');
              const height = document.getElementById('height');
              
              if (!length || !width || !height) {
                showError('Please enter all container dimensions');
                return false;
              }
            }
            
            if (!fileInput.files || !fileInput.files[0]) {
              showError('Please upload an inventory file');
              return false;
            }

            // Get all constraint weights with correct names (matching what backend expects)
            const constraintWeights = {
              volume_weight: document.getElementById('volume_weight').value,
              stability_weight: document.getElementById('stability_weight').value,
              contact_weight: document.getElementById('contact_weight').value,
              balance_weight: document.getElementById('balance_weight').value,
              items_packed_weight: document.getElementById('items_packed_weight').value,
              temperature_weight: document.getElementById('temperature_weight').value,
              weight_capacity: document.getElementById('weight_capacity').value
            };

            // Add constraint weights to form data
            Object.entries(constraintWeights).forEach(([key, value]) => {
              const input = document.createElement('input');
              input.type = 'hidden';
              input.name = key;
              input.value = value;
              optimizerForm.appendChild(input);
            });
            
            // Show loading overlay with genetic algorithm specific messaging
            const loadingOverlay = document.getElementById('loadingOverlay');
            const loadingText = document.querySelector('.loading-text');
            const loadingStatus = document.querySelector('.loading-status');
            
            if (loadingOverlay) {
              // Check if genetic algorithm is selected
              const algorithmInput = document.getElementById('optimization_algorithm');
              const isGenetic = algorithmInput && algorithmInput.value === 'genetic';
              
              if (isGenetic) {
                const populationSize = document.getElementById('population_size').value;
                const generations = document.getElementById('num_generations').value;
                
                if (loadingText) {
                  loadingText.textContent = 'AI-Enhanced Genetic Optimization';
                }
                if (loadingStatus) {
                  loadingStatus.textContent = `Running genetic algorithm with ${populationSize} population size and ${generations} generations. This may take 1-2 minutes...`;
                }
              } else {
                if (loadingText) {
                  loadingText.textContent = 'Optimizing Container';
                }
                if (loadingStatus) {
                  loadingStatus.textContent = 'Analyzing item dimensions and constraints...';
                }
              }
              
              loadingOverlay.style.display = 'flex';
            }
            
            // Submit the form
            this.submit();
          });
        }

        function validateCurrentStep(stepNum) {
          switch(stepNum) {
            case 1:
              // Validate transport mode and container selection
              if (!transportModeInput || !transportModeInput.value) {
                showError('Please select a transport mode');
                return false;
              }
              
              if (transportModeInput.value !== '5' && (!containerTypeInput || !containerTypeInput.value)) {
                showError('Please select a container type');
                return false;
              }
              
              if (transportModeInput.value === '5') {
                const length = document.getElementById('length');
                const width = document.getElementById('width');
                const height = document.getElementById('height');
                
                if (!length || !length.value || !width || !width.value || !height || !height.value) {
                  showError('Please enter all custom container dimensions');
                  return false;
                }
              }
              return true;
              
            case 2:
              // Validate file upload
              if (!fileInput || !fileInput.files || !fileInput.files[0]) {
                showError('Please upload an inventory file');
                return false;
              }
              return true;
              
            case 3:
              // Settings validation (temperature is optional)
              return true;
              
            default:
              return true;
          }
        }
      });
    </script>
  </body>
</html>